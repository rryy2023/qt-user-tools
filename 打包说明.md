# 打包说明

## 打包结果

打包已完成！生成的可执行文件位于 `dist/` 目录：

- **文件名**: `千图网问题解决工具`
- **大小**: 约 13MB
- **类型**: macOS 可执行文件 (Mach-O 64-bit executable x86_64)

## 使用方法

### 运行打包后的应用

```bash
# 直接运行
./dist/千图网问题解决工具

# 需要管理员权限时
sudo ./dist/千图网问题解决工具
```

### 分发应用

1. **Mac用户**: 可以直接运行 `dist/千图网问题解决工具` 文件
2. **创建DMG安装包**（可选）:
   ```bash
   # 使用create-dmg工具创建DMG
   create-dmg dist/千图网问题解决工具.dmg dist/
   ```

## 打包配置

打包使用的配置文件：
- `build.spec` - PyInstaller配置文件

### 重新打包

如果需要重新打包：

```bash
# 清理之前的构建
rm -rf build/ dist/

# 使用自定义脚本打包（跳过代码签名）
python3 build_no_sign.py

# 或使用PyInstaller直接打包（如果代码签名可用）
pyinstaller build.spec --clean
```

**注意**: 由于Mac代码签名问题，建议使用 `build_no_sign.py` 脚本打包，它会自动跳过代码签名步骤。

## 打包选项说明

### 当前配置

- **单文件模式**: 所有依赖打包到一个可执行文件
- **无控制台窗口**: `console=False`，GUI应用不显示终端
- **包含资源**: 自动包含 `gui/resources` 和 `config` 目录

### 自定义打包

编辑 `build.spec` 文件可以自定义：

1. **添加图标**:
   ```python
   icon='path/to/icon.icns'  # Mac图标
   ```

2. **修改应用名称**:
   ```python
   name='YourAppName'
   ```

3. **添加额外数据文件**:
   ```python
   datas=[
       ('gui/resources', 'gui/resources'),
       ('config', 'config'),
       ('additional/data', 'data'),  # 添加更多数据
   ],
   ```

## 注意事项

### Mac系统

1. **首次运行**: 可能需要在"系统偏好设置 > 安全性与隐私"中允许运行
2. **代码签名**: 如需分发，建议进行代码签名
3. **公证**: 如需在App Store分发，需要进行公证

### 权限问题

- 修改hosts文件需要管理员权限
- 建议在应用启动时检查权限并提示用户

## 文件大小优化

当前打包大小约 13MB，包含：
- Python运行时
- PyQt6库
- 所有依赖模块
- 资源文件

如需减小体积，可以考虑：
1. 使用 `--onefile` 模式（已使用）
2. 排除不需要的模块
3. 使用UPX压缩（已启用）

## 跨平台打包

### Windows

在Windows系统上打包：
```bash
pyinstaller build.spec
```
会生成 `.exe` 文件

### Linux

在Linux系统上打包：
```bash
pyinstaller build.spec
```
会生成可执行文件

## 故障排除

### 打包失败

1. 检查所有依赖是否已安装
2. 检查Python版本兼容性
3. 查看 `build/warn-build.txt` 了解警告信息

### 运行错误

1. 检查是否有缺失的依赖
2. 查看控制台错误信息
3. 使用 `--debug` 模式打包以获取更多信息

## 测试

打包后建议测试：
1. 基本功能测试
2. 权限测试（管理员/普通用户）
3. 不同系统版本测试
